# A General Gaussian Heatmap Label Assignment for Arbitrary-Oriented Object Detection

> Zhanchao Huang

|Model|mAP|Conference|Recommond|
|--|--|--|--|
|GGHL|76.95|-|:white_check_mark:|

AOOD = Arbitrary oriented object detection

大多基于锚框或标准高斯热图。这种标签分配策略不仅不能反映任意定向对象的形状和方向特征，而且具有很高的参数调整努力

提出了一种新的AOOD方法，称为广义高斯热图标签分配（GGHL）

提出了一种基于二维（2-D）定向高斯热图的无锚对象自适应标签分配（OLA）策略来定义正候选，该热图反映了任意定向对象的形状和方向特征。基于OLA，开发了一种定向边界盒（OBB）表示组件（ORC），用于指示OBB，并通过神经网络学习自适应调整高斯中心先验权重以适应不同对象的特性。此外，设计了具有面积归一化和动态置信加权的联合优化损失（JOL），以细化不同子任务的未对准优化结果

---

CNN训练本质上是学习从多个候选位置的预测到标记对象的一对多映射的过程。不同的一对多标签分配策略通过为训练生成不同的地面真值（称为样本空间）直接影响检测性能。因此，为了提高检测性能，一种方法是使用更复杂的CNN，即更复杂的近似函数。另一种方法是设计标签分配策略，以构建更符合对象形状和方向特征的更好的样本空间。在目标检测任务中，后者与前者同样重要

大多数AOOD方法,使用基于锚的标签分配策略,当默认锚框无法覆盖特定形状时，该策略可能导致正负（P&N）位置不匹配和摆脱对锚形状的依赖

预期的训练样本空间还需要适当的目标函数来指导模型学习更高质量的特征

无论是OD任务还是AOOD任务，主流目标函数范式都是独立优化分类和OBB回归任务，并将每个损失的总和最小化作为优化目标。然而，可能存在两种情况之一：精确定位的对象具有较低的分类分数，或者精确分类的对象具有较高的OBB回归分数。因此，正如PISA、自由锚、自动分配等所分析的，联合优化不同的子任务是一个更合理的目标。此外，应考虑到不同物体可能具有不同数量的正位置，不同位置对损失函数的贡献不相等

总之，不匹配、过度松弛或过度严格的标签分配策略使得构建的训练样本空间难以适应对象特征，并且可能具有许多超参数。此外，不同子任务的不一致损失函数使得在样本空间中学习CNN的最佳参数更具挑战性。

因此，对于基于CNN的AOOD方法，与开发令人眼花缭乱的网络结构相比，构建对象自适应标签分配策略和设计目标一致性损失函数更为重要。在这方面，提出了一种新的、实用的AOOD方法，称为广义高斯热图标签分配（GGHL），该方法具有更高的性能和更少的超参数。

- 基于面向二维高斯热图，提出了一种无任何先验锚框的对象自适应标签分配（OLA）策略。它简化了P&N位置定义，并使正位置的分布更加灵活，以适应对象的大小和方向

- 基于从正点到OBB顶点的距离，开发了一个定向边界盒表示组件（ORC），该组件表示没有锚定盒的任何OBB。此外，设计了一种对象自适应权值调整机制（OWAM），用于自适应调整不同位置的高斯中心先验权值，并用于加权不同P&N位置的损失

- 提出了一种具有面积归一化和动态加权的联合优化损失（JOL）。它通过联合优化其似然函数（LF）来细化正负位置、OBB回归和分类任务之间的未对准优化目标。此外，它还平衡了模型在不同位置对不同类别、不同大小的对象的学习偏好。
