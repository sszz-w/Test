# Anchor Retouching via Model Interaction for Robust Object Detection in Aerial Images

> Dong Liang, TGRS

|Model|mAP|Conference|Recommond|
|--|--|--|--|
|DEA-Net|80.37|TGRS|:white_check_mark:|

小对象检测是个挑战，要收集足够的正/负样本进行启发式训练，大多的检测器预设了区域锚点，针对ground truth数据计算交集比联合IoU

小物体常常会被遗弃或者贴错标签

该论文提出了有效的动态增强锚DEA网络来构建一种新的训练样本生成器

- 提出的网络利用样本鉴别器实现基于锚和无锚单元之间的交互式样本筛选，生成符合条件的样本

- 基于锚的推理方案的多任务联合训练提高了所提出模型的性能，降低了计算复杂度

---

区域锚被设计为回归参考和分类候选，以预测两阶段中的proposal或者一阶段中的最后边界框

大多数基于anchor的检测器都采用统一的anchor方案，通过与ground truth和IoU选择正负样本

但是这会有问题：

- 锚量化误差和噪声训练样本：anchor大小定为32，IoU定位0.5，那么目标$< 32^2 \times 0.5$(512 pixels)就不会被列为正类；面积$< 512$的类在DOTA图像中大约有30%，不准确的锚框或样本错误分类回到是模型收敛不稳定

- 金字塔级别和样本之间的不匹配：
    1. 上层特征图具有更多适合检测大实例的语义信息，而下层特征图具有更多适合检测小实例的细粒度细节
    2. 集成在特征金字塔中，大的锚提议通常与上层特征图相关联，而小锚提议与下层特征图相关联
    3. 背景区域大的边界框不准确会导致特征金字塔层级与训练样本不匹配，极大地影响模型训练
    4. 用于训练每个样本的所选特征级别可能不正确

可以使用更多级别的图像特征金字塔来更好地检测小物体；另一种常见的解决方案是增加具有不同尺寸和纵横比的锚的数量

它们都会导致显着的计算开销，尤其是在处理大规模航拍图像或训练具有沉重主干的网络时

无锚检测器FCOS中的回归边界框可以潜在地用作正区域建议，因为它们没有锚量化误差

无锚点检测器通常无法在对象尺寸大且纵横比极端时生成准确的边界框

大多数基于锚的检测器（ Faster R-CNN）从锚框回归，锚框和目标框之间有四个偏移量，而 FCOS 从一个点回归，距离目标边界有四个距离

- 对于一个正样本，Faster R-CNN 的回归起始状态是一个框，而 FCOS 是一个点

- box 本身包含形状的先验，回归只是X和Y方向的两个小偏移

- FCOS 需要独立地返回 +/-X 和 Y 四个方向的偏移量，从起点开始，没有任何形状先验

基于锚的方法，大对象的锚量化误差可以忽略不计

锚框旨在将所有可能的实例框离散为有限数量的具有预定义位置、比例和纵横比的框。

在任意方向的检测中，我们需要更多尺寸更小、布局更密集或角度更多的anchors来覆盖小物体，这可能会导致大量的计算成本和正负样本不平衡的问题。

DEA网络来有效地增强对小物体的学习;DEA 头服务于特征金字塔的每个级别，包括一个基于锚的模块、一个无锚模块和一个样本鉴别器

样本鉴别器将互补的基于锚的提议和无锚提议合并，并生成具有准确位置和大小的具有代表性和信息丰富的样本，同时避免正/负混淆。此外，采用保守的基于锚的推理方案的多任务联合训练提高了模型的性能，同时避免了复杂性的增加