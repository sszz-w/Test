# The KFIoU Loss for Rotated Object Detection

> Xue Yang

Differing from the well-developed horizontal object detection area whereby the computing-friendly IoU based loss is readily adopted and well fits with the detection metrics.

In this paper, we argue that one effective alternative is to devise an approximate loss who can achieve trend-level alignment with SKewIoU loss instead of the strict value-level identity.

Specifically, we model the objects as Gaussian distribution and adopt Kalman filter to inherently mimic the mechanism of SkewIoU by its definition, and show its alignment with the SkewIoU at trend-level.

The resulting new loss called KFIoU is easier to implement and works better compared with exact SkewIoU, thanks to its full differentiability and ability to handle the non-overlapping cases.

This paper aims to find an easy-to-implement and better-performing alternative. By calculating the error variance and comparing the final performance, we find the key to maintaining the consistency between metric and regression loss (including L1, KLD, GWD and KFIoU etc.) lies in the trend-level consistency between approximate and exact SkewIoU loss rather than value-level consistency.

Then we use a center point loss to narrow the distance between the center of the two Gaussian distributions, follow by calculating the overlap area under the new position through Kalman filter.

1) For rotation detection, instead of exactly computing the SkewIoU loss which is tedious and unfriendly to differentiable learning, we propose our new approximate loss - KFIoU loss. It follows the protocol of Gaussian modeling for objects, yet innovatively uses Kalman filter to mimic SkewIoU's computing mechanism.

2) Compared with plain SkewIoU loss, our KFIoU loss is easy-to-implement, and works better due to fully differentiable and able to handle the non-overlapping cases. Compared to Gaussian-based losses (GWD, KLD) that try to approximate SkewIoU by specifying a distance which requires extra hyperparameters tuning and metric selection, our mechanism level simulation to SkewIoU is more interpretable and natural, and free from hyperparameter tuning.

3) We show that KFIoU achieves a trend-level alignment with SkewIoU, where the trend deviation is measured by our devised error variance. While the error variance for GWD and KLD are much larger. The effectiveness of such a trend-level alignment strategy is verified by comparing KFIoU with ideal SkewIoU. On extensive benchmarks (aerial images, scene texts, face), our approach also outperforms other SOTA alternatives (GWD, KLD).

4) We further extend the Gaussian modeling and KFIoU loss from 2-D to 3-D rotation detection, with notable improvement compared with baselines. To our best knowledge, this is the first 3-D rotation detector based on Gaussian modeling which also verifies its effectiveness, which is in contrast to focusing on 2-D rotation detection.

-----------

旋转检测器通常涉及基于SkewIoU的更复杂的损失，这不利于基于梯度的训练

一种有效的替代方法是设计一个近似损失，该损失可以实现与SkewIoU损失的趋势水平对齐，而不是严格的value-level恒等式

将对象建模为高斯分布，并采用卡尔曼滤波器根据其定义固有地模拟SkewIoU的机制，并在趋势级别显示其与SkewIoU的对齐

最近基于高斯建模的旋转检测器（例如GWD、KLD）形成对比，后者涉及人类指定的分布距离度量，需要额外的超参数调整

由于其完全可微性和处理非重叠情况的能力，与精确SkewIoU相比，产生的称为KFIoU的新损失更易于实现，并且工作得更好

